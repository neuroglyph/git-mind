#!/bin/bash
# SPDX-License-Identifier: LicenseRef-MIND-UCAL-1.0
# Â© 2025 J. Kirby Ross / Neuroglyph Collective

# Pre-push hook - run tests before pushing

echo "ğŸš€ Running pre-push checks..."

# Ensure Docker image is built with optimizations
export COMPOSE_BAKE=true
export DOCKER_BUILDKIT=1

# Run quick quality checks
echo "ğŸ“‹ Running quick quality checks..."
if ! make check-quality; then
    echo "âŒ Quality checks failed!"
    echo "Fix issues before pushing."
    exit 1
fi

# Run tests
echo "ğŸ§ª Running tests..."
if ! make test; then
    echo "âŒ Tests failed!"
    echo "All tests must pass before pushing."
    exit 1
fi

echo "âœ… All pre-push checks passed!"
echo "Pushing to remote..."